## N+1 이슈

A 엔티티를 조회 시 연관되어 있는 B엔티티를 조회할 때 하나씩 조회하는 이슈

> 주의할 점   
> 영속성 컨텍스트에 B엔티티 내용이 들어가있으면 N+1문제가 생기지 않음   
> 하지만 없을 경우는 똑같이 N+1문제가 생기니 주의해야함

### 해결 방법

1. fetch join

JPQL을 사용해서 join fetch로 A,B 엔티티를 한번에 영속성 컨텍스트로 데려온다.

```kotlin
@Query("SEELCT t FROM team t JOIN FETCH t.members")
fun find()
```

2. batch size
 
IN절로 가져올 수 있도록 함

application.yml에 추가
```yml
spring.jpa.properties.hibernate.default_batch_fetch_size: 1000
```

IN절에 5000개가 들어가게 되면 최대 개수인 1000씩 잘라서 5번 호출한다.
