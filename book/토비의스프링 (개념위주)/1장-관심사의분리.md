í† ë¹„ì˜ ìŠ¤í”„ë§ì—ì„œëŠ” DAOë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ëª…ì„ í•˜ê³  ìˆë‹¤.
ê·¸ë˜ì„œ ì²˜ìŒì˜ ì½”ë“œë§Œ ê°€ì ¸ì˜¨ í›„ì— ì‹œì‘í•œë‹¤.
```java
package springbook.user.dao;

public class UserDao {
    public void add(User user) throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.jdbc.Driver");
        Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
        PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values(?,?,?)");
        ps.setString(1, user.getId());
        ps.setString(2, user.getName());
        ps.setString(3, user.getPassword());
        ps.executeUpdate();
        ps.close();
        c.close();
    }

    public User get(String id) throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.jdbc.Driver");
        Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
        PreparedStatement ps = c.prepareStatement("select * from users where id = ?");
        ps.setString(1, id);
        ResultSet rs = ps.executeQuery();
        rs.next();
        
        User user = new User();
        user.setId(rs.getString("id"));
        user.setName(rs.getString("name"));
        user.setPassword(rs.getString("password"));
        
        rs.close();
        ps.close();
        c.close();
        
        return user;
    }
}
```

ì½”ë“œ ë³´ëŠ” ìˆœê°„ ì¢€ ì•„ì°”í•˜ë‹¤.
ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ì— ë”°ë¼ ë‚˜ëˆ ë³´ì
- ê°œë°œìê°€ ê°ì²´ë¥¼ ì„¤ê³„í•  ë•Œ ê°€ì¥ ì—¼ë‘ì— ë‘¬ì•¼ í•  ì‚¬í•­ì€ **ë¯¸ë˜ì˜ ë³€í™”ë¥¼ ì–´ë–»ê²Œ ëŒ€ë¹„í•  ê²ƒì¸ê°€** <- ê°€ì¥ ë§ˆìŒì— ì™€ë‹¿ì€ ë§
- ë³€í™”ê°€ ìƒê²¼ì„ ë–„ í•œ ê°€ì§€ ê´€ì‹¬ì— ì§‘ì¤‘ë˜ì–´ ì¼ì–´ë‚œë‹¤ë©´ í•œ êµ°ë°ë§Œ ì§‘ì¤‘í•˜ë©´ ëœë‹¤.

## UserDao ê´€ì‹¬ì‚¬

1. DB ì—°ê²°ì„ ìœ„í•œ ì»¤ë„¥ì…˜ì„ ì–´ë–»ê²Œ ê°€ì ¸ì˜¬ê¹Œ
   1. ì–´ë–¤ ë“œë¼ì´ë²„ ì‚¬ìš©?
   2. ì»¤ë„¥ì…˜ì„ ìƒì„±í•˜ëŠ” ë°©ë²•?
2. ì‚¬ìš©ì ë“±ë¡ì„ ìœ„í•œ SQL
   1. íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜¨ ì‚¬ìš©ì ì •ë³´ë¥¼ ì–´ë–»ê²Œ ë°”ì¸ë”©í• ì§€
   2. ì–´ë–»ê²Œ ì‹¤í–‰í• ì§€
3. ì‘ì—…ì´ ëë‚œ í›„ ì»¤ë„¥ì…˜ì„ ë‹«ëŠ” ë°©ë²•

- ê°€ì¥ í° ë¬¸ì œì ì€ DBì—°ê²°ì„ ìœ„í•œ ì»¤ë„¥ì…˜ì„ DAOë§ˆë‹¤ í•´ì¤˜ì•¼ëœë‹¤ëŠ” ê²ƒì´ë‹¤. (ìˆ˜ì • ì‹œ ëª¨ë‘ ìˆ˜ì • í•„ìš”)

UserDaoë¥¼ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ êµ¬ì„±í•˜ì—¬ ê³µí†µ ê¸°ëŠ¥ì„ ì œê³µí•˜ë„ë¡ í•œë‹¤.    
 -> ê¸°ëŠ¥ì˜ ì¼ë¶€ë¥¼ ì¶”ìƒ ë©”ì„œë“œë‚˜ ì˜¤ë²„ë¼ì´ë”©ì´ ê°€ëŠ¥í•œ protected ë©”ì„œë“œ ë“±ìœ¼ë¡œ ë§Œë“¤ì–´ í•„ìš”ì— ë§ê²Œ êµ¬í˜„í•˜ë„ë¡ í•œë‹¤.   
 -> **í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´**

- í•˜ì§€ë§Œ ìƒì†ì€ ìŠˆí¼ í´ë˜ìŠ¤ê°€ ìˆ˜ì •ì´ ë˜ë©´ ëª¨ë“  ì„œë¸Œ í´ë˜ìŠ¤ê°€ ëª¨ë‘ ìˆ˜ì •í•´ì•¼ ë  ìˆ˜ ìˆë‹¤. ğŸ¤®

- ê²°êµ­ ê´€ì‹¬ì‚¬ë¥¼ ë…ë¦½ì‹œí‚¤ë©´ì„œ ë™ì‹œì— ì†ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì°¾ì•„ì•¼í•œë‹¤.  
  (ë‹¤ë¥¸ í´ë˜ìŠ¤ê°€ ê°€ì ¸ê°€ì!)

## DB connection ê´€ì‹¬ì‚¬ ë¶„ë¦¬

- ë°©ë²• 1
  - **connectionì„ ë‹´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ UserDaoê°€ new ìƒì„±ìë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•œë‹¤.**
    - ë¬¸ì œì 
      - ê²°êµ­ì—” UserDaoê°€ DB ì—°ê²° ë°©ë²•ì„ ë°”ê¿”ì•¼í•œë‹¤.
        - ìƒì†í•œ ë‹¤ë¥¸ í´ë˜ìŠ¤ê°€ DB ì—°ê²° ë°©ë²•ì„ ë°”ê¿€ ìˆ˜ ì—†ë‹¤. (ì¢…ì†ë˜ì–´ë²„ë ¸ë‹¤.)
      - UserDao ë‚´ì— ìˆëŠ” ë©”ì„œë“œì˜ ì»¤ë„¥ì…˜ì„ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œë¥¼ ëª¨ë‘ ìˆ˜ì •í•´ì•¼ëœë‹¤.

ë¬¸ì œì ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ì…í•œë‹¤. -> UserDaoê°€ ìì‹ ì´ ì‚¬ìš©í•  í´ë˜ìŠ¤ë¥¼ ì•Œ í•„ìš”ê°€ ì—†ë‹¤!


ì»¤ë„¥ì…˜ ë§ºëŠ” í´ë˜ìŠ¤ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„ í•˜ë„ë¡ í•œë‹¤.
```java
package springbook.user.dao;

public class DConnectionMaker implements ConnectionMaker {
    public Connection makeConnection() throws ClassNotFoundException, SQLException {
    // D ì‚¬ì˜ ë…ìì ì¸ ë°©ë²•ìœ¼ë¡œ Connectionì„ ìƒì„±í•˜ëŠ” ì½”ë“œ
    }
}
```

ì—¬ê¸°ì„œ ìŠ¬í”„ê²Œë„ UserDaoì—ëŠ” new DConnectionMaker() ë¶€ë¶„ì´ ë‚¨ì•„ìˆë‹¤.
í•µì‹¬ì€ UserDaoê°€ connectionê¹Œì§€ ê´€ì‹¬ì„ ì—†ê²Œ ë§Œë“œëŠ”ê±°ë‹¤. -> ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒì´ ì»¤ë„¥ì…˜ì„ ê³ ë¥´ì

```java
public UserDao(ConnectionMaker connectionMaker) {
    this.connectionMaker = connectionMaker;
}
```


ìœ„ì—ì„œ ë¦¬í™í† ë§í•œ ë‚´ìš©ì€ ì›ë¦¬ì™€ íŒ¨í„´ë¡œë„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤.

## ê°œë°© íì‡„ ì›ì¹™

> í´ë˜ìŠ¤ë‚˜ ëª¨ë“ˆì€ í™•ì¥ì—ëŠ” ì—´ë ¤ìˆì–´ì•¼í•˜ê³  ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼í•œë‹¤.

- ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì œê³µë˜ëŠ” í™•ì¥ í¬ì¸íŠ¸ëŠ” ì—´ë ¤ìˆì§€ë§Œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ëŠ” ë³€í™”ì— êµ³ê²Œ ë‹«í˜€ìˆë‹¤.

## ë†’ì€ ì‘ì§‘ë„ì™€ ë‚®ì€ ê²°í•©ë„
- ë†’ì€ ì‘ì§‘ë„
> í•˜ë‚˜ì˜ ëª¨ë“ˆì´ í•˜ë‚˜ì˜ ì±…ì„ì— ì§‘ì¤‘ = ë†’ì€ ì‘ì§‘ë„   
> ëª¨ë“ˆì˜ ì—­í• ì´ ëª…í™•í•˜ê³  ë…ë¦½ì 
- ë‚®ì€ ê²°í•©ë„
> ëª¨ë“ˆ ê°„ì˜ ì˜ì¡´ì„±ì´ ìµœì†Œí™”ë˜ì–´, í•œ ëª¨ë“ˆì´ ë³€ê²½ë˜ì–´ë„ ë‹¤ë¥¸ ëª¨ë“ˆì— ì˜í–¥ì„ ê±°ì˜ ë¯¸ì¹˜ì§€ ì•ŠëŠ” ìƒíƒœ   
> êµ¬í˜„ í´ë˜ìŠ¤ê°€ ë³€ê²½ë˜ì–´ë„ ì „íŒŒë˜ì§€ ì•Šì•„ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
